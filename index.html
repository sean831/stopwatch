<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7.77 ì±Œë¦°ì§€ - TV ìµœì¢…íŒ</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --toss-blue: #0064ff;
            --toss-red: #f04452;
            --toss-text-black: #191f28;
            --toss-text-grey: #8b95a1;
            --gold: #ffbb00;
        }

        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: white;
            font-family: 'Pretendard', sans-serif;
            color: var(--toss-text-black);
            overflow: hidden;
        }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ: ìœ„ì¹˜ë¥¼ ê³ ì •ì‹œì¼œì„œ ë©”ì‹œì§€ê°€ ë– ë„ ë°€ë¦¬ì§€ ì•Šê²Œ í•¨ */
        .main-wrapper {
            position: relative;
            text-align: center;
            width: 100vw;
            z-index: 1;
        }

        h1 {
            font-size: 3.5vw;
            color: var(--toss-text-grey);
            margin: 0;
            font-weight: 700;
        }

        #timer {
            font-size: 32vw;
            font-weight: 850;
            margin: -2vw 0;
            line-height: 1;
            font-variant-numeric: tabular-nums;
            letter-spacing: -1.5vw;
            transition: color 0.2s ease;
        }

        .instruction {
            font-size: 2.5vw;
            color: white;
            background: var(--toss-blue);
            padding: 1.2vw 4vw;
            border-radius: 100px;
            display: inline-block;
            margin-top: 1vw;
            min-width: 30vw;
        }

        /* ê²°ê³¼ ë©”ì‹œì§€: position: fixedë¡œ ì„¤ì •í•˜ì—¬ ê¸°ì¡´ ë ˆì´ì•„ì›ƒì„ ì ˆëŒ€ ë°€ì§€ ì•ŠìŒ */
        #result-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }

        #result-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .prize-tag {
            font-size: 5vw;
            font-weight: 800;
            margin-bottom: 1vw;
        }

        .prize-msg {
            font-size: 10vw;
            font-weight: 900;
            color: var(--toss-blue);
            text-shadow: 0 10px 30px rgba(0, 100, 255, 0.2);
        }

        .prize-info {
            font-size: 3vw;
            color: var(--toss-text-grey);
            margin-top: 2vw;
        }
    </style>
</head>
<body>

    <div id="result-overlay">
        <div class="prize-tag" id="prizeTag">ë“±ê¸‰</div>
        <div class="prize-msg" id="prizeMsg">ì¶•í•˜í•©ë‹ˆë‹¤!</div>
        <div class="prize-info">ë²„íŠ¼ì„ ëˆŒëŸ¬ ì´ˆê¸°í™”</div>
    </div>

    <div class="main-wrapper">
        <h1 id="title">7.77ì´ˆ ì±Œë¦°ì§€</h1>
        <div id="timer">0.00</div>
        <div class="instruction" id="statusBox">
            <span id="statusText">ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œì‘</span>
        </div>
    </div>

    <script>
        let startTime;
        let elapsedTime = 0;
        let timerInterval;
        let state = 'READY'; 

        const timerDisplay = document.getElementById('timer');
        const statusText = document.getElementById('statusText');
        const statusBox = document.getElementById('statusBox');
        const overlay = document.getElementById('result-overlay');
        const prizeTag = document.getElementById('prizeTag');
        const prizeMsg = document.getElementById('prizeMsg');

        function updateDisplay() {
            const now = Date.now();
            elapsedTime = (now - startTime) / 1000;
            timerDisplay.textContent = elapsedTime.toFixed(2);
        }

        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(updateDisplay, 10);
            state = 'RUNNING';
            statusText.textContent = 'ë²„íŠ¼ì„ ëˆŒëŸ¬ ì •ì§€';
            statusBox.style.backgroundColor = varColor('--toss-red');
            overlay.classList.remove('show');
            timerDisplay.style.color = 'var(--toss-text-black)';
        }

        function stopTimer() {
            clearInterval(timerInterval);
            state = 'STOPPED';
            statusText.textContent = 'ë²„íŠ¼ì„ ëˆŒëŸ¬ ì´ˆê¸°í™”';
            statusBox.style.backgroundColor = varColor('--toss-text-black');
            
            checkResult();
        }

        function resetTimer() {
            elapsedTime = 0;
            timerDisplay.textContent = "0.00";
            state = 'READY';
            statusText.textContent = 'ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œì‘';
            statusBox.style.backgroundColor = varColor('--toss-blue');
            overlay.classList.remove('show');
            timerDisplay.style.color = 'var(--toss-text-black)';
        }

        function checkResult() {
            const result = parseFloat(elapsedTime.toFixed(2));
            const diff = Math.abs(result - 7.77);
            
            // ë“±ìˆ˜ íŒì • ë¡œì§
            if (result === 7.77) {
                showPrize("âœ¨ 1ë“± ìƒí’ˆ âœ¨", "7.77 í¼í™íŠ¸!", "var(--gold)", 200);
            } else if (diff <= 0.02) {
                showPrize("ğŸ¥ˆ 2ë“± ìƒí’ˆ ğŸ¥ˆ", "ì•„ê¹ë‹¤! ê±°ì˜ ì™„ë²½í•´ìš”", "var(--toss-blue)", 100);
            } else if (diff <= 0.05) {
                showPrize("ğŸ¥‰ 3ë“± ìƒí’ˆ ğŸ¥‰", "ëŒ€ë‹¨í•´ìš”! ì„±ê³µì…ë‹ˆë‹¤", "#505967", 50);
            }
        }

        function showPrize(tag, msg, color, confettiCount) {
            prizeTag.textContent = tag;
            prizeTag.style.color = color;
            prizeMsg.textContent = msg;
            overlay.classList.add('show');
            triggerConfetti(confettiCount);
        }

        function triggerConfetti(count) {
            const defaults = { origin: { y: 0.7 }, zIndex: 200 };
            confetti({ ...defaults, particleCount: count, spread: 70, startVelocity: 60 });
            
            // ë” í™”ë ¤í•˜ê²Œ 3ë²ˆ ë‚˜ëˆ ì„œ í„°ëœ¨ë¦¼
            setTimeout(() => {
                confetti({ ...defaults, particleCount: count/2, spread: 100, origin: {x: 0.2, y: 0.8} });
                confetti({ ...defaults, particleCount: count/2, spread: 100, origin: {x: 0.8, y: 0.8} });
            }, 200);
        }

        // CSS ë³€ìˆ˜ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” í—¬í¼ í•¨ìˆ˜
        function varColor(name) {
            return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
        }

        window.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                if (state === 'READY') startTimer();
                else if (state === 'RUNNING') stopTimer();
                else if (state === 'STOPPED') resetTimer();
            }
        });
    </script>
</body>
</html>
